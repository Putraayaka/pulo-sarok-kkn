{% extends 'admin/base.html' %}
{% load static %}

{% block title %}Kelola Kategori{% endblock %}

{% block page_title %}Kelola Kategori{% endblock %}

{% block content %}
{% csrf_token %}
<div class="p-6">
    <!-- Header Section -->
    <div class="mb-8">
        <div class="bg-gradient-to-r from-blue-600 to-purple-700 rounded-lg p-6 text-white">
            <h1 class="text-2xl font-bold mb-2">Kelola kategori untuk semua jenis bisnis</h1>
            <p class="text-blue-100">Manajemen kategori bisnis, jenis koperasi, dan kategori layanan jasa</p>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6 mb-8">
        <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-3 md:p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-blue-100 text-xs md:text-sm font-medium uppercase tracking-wide">Total Kategori</p>
                    <p class="text-blue-100 text-xs md:text-sm font-medium uppercase tracking-wide md:hidden">Bisnis</p>
                    <p class="text-lg md:text-2xl font-bold" id="totalBusinessCategories">0</p>
                </div>
                <div class="bg-blue-400 bg-opacity-30 rounded-full p-2 md:p-3">
                    <i class="fas fa-tags text-sm md:text-xl"></i>
                </div>
            </div>
        </div>
        
        <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-3 md:p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-green-100 text-xs md:text-sm font-medium uppercase tracking-wide">Jenis</p>
                    <p class="text-green-100 text-xs md:text-sm font-medium uppercase tracking-wide md:hidden">Koperasi</p>
                    <p class="text-lg md:text-2xl font-bold" id="totalJenisKoperasi">0</p>
                </div>
                <div class="bg-green-400 bg-opacity-30 rounded-full p-2 md:p-3">
                    <i class="fas fa-handshake text-sm md:text-xl"></i>
                </div>
            </div>
        </div>
        
        <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-3 md:p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-purple-100 text-xs md:text-sm font-medium uppercase tracking-wide">Kategori</p>
                    <p class="text-purple-100 text-xs md:text-sm font-medium uppercase tracking-wide md:hidden">Jasa</p>
                    <p class="text-lg md:text-2xl font-bold" id="totalKategoriJasa">8</p>
                </div>
                <div class="bg-purple-400 bg-opacity-30 rounded-full p-2 md:p-3">
                    <i class="fas fa-tools text-sm md:text-xl"></i>
                </div>
            </div>
        </div>
        
        <div class="bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-3 md:p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-orange-100 text-xs md:text-sm font-medium uppercase tracking-wide">Total</p>
                    <p class="text-orange-100 text-xs md:text-sm font-medium uppercase tracking-wide md:hidden">Aktif</p>
                    <p class="text-lg md:text-2xl font-bold" id="totalActiveCategories">0</p>
                </div>
                <div class="bg-orange-400 bg-opacity-30 rounded-full p-2 md:p-3">
                    <i class="fas fa-check-circle text-sm md:text-xl"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="border-b border-gray-200">
            <nav class="-mb-px flex flex-wrap gap-2 px-6" aria-label="Tabs">
                <button onclick="switchTab('business')" id="business-tab" class="tab-button active border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-3 border-b-2 font-medium text-sm">
                    <i class="fas fa-store mr-2"></i>
                    Kategori Bisnis
                </button>
                <button onclick="switchTab('koperasi')" id="koperasi-tab" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-3 border-b-2 font-medium text-sm">
                    <i class="fas fa-handshake mr-2"></i>
                    Jenis Koperasi
                </button>
                <button onclick="switchTab('ukm')" id="ukm-tab" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-3 border-b-2 font-medium text-sm">
                    <i class="fas fa-industry mr-2"></i>
                    UKM
                </button>
                <button onclick="switchTab('bumg')" id="bumg-tab" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-3 border-b-2 font-medium text-sm">
                    <i class="fas fa-building mr-2"></i>
                    BUMG
                </button>
                <button onclick="switchTab('jasa')" id="jasa-tab" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-3 border-b-2 font-medium text-sm">
                    <i class="fas fa-tools mr-2"></i>
                    Layanan Jasa
                </button>
                <button onclick="switchTab('aset')" id="aset-tab" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-3 border-b-2 font-medium text-sm">
                    <i class="fas fa-boxes mr-2"></i>
                    Aset
                </button>
            </nav>
        </div>
    </div>

    <!-- Tab Content -->
    <div class="bg-white rounded-lg shadow overflow-hidden">
        <!-- Business Category Tab -->
        <div id="business-content" class="tab-content active">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="mb-4 md:mb-0">
                        <h3 class="text-lg font-medium text-gray-900">Kategori Bisnis</h3>
                        <p class="text-sm text-gray-500">Kelola kategori untuk semua jenis bisnis</p>
                    </div>
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex">
                            <input type="text" id="searchBusinessInput" placeholder="Cari kategori bisnis..." class="px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <button onclick="searchBusinessCategories()" class="px-4 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-md hover:bg-gray-200">
                                <i class="fas fa-search text-gray-600"></i>
                            </button>
                        </div>
                        <button onclick="openAddBusinessModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i>
                            Tambah Kategori
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Desktop Table View -->
            <div class="hidden md:block overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Kategori</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Deskripsi</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal Dibuat</th>
                            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="businessCategoryTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
            
            <!-- Mobile Card View -->
            <div class="md:hidden" id="businessCategoryCardContainer">
                <!-- Mobile cards will be loaded here -->
            </div>
            
            <!-- Pagination -->
            <div class="px-6 py-4 border-t border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-700">
                        Menampilkan <span id="businessShowingStart">1</span> sampai <span id="businessShowingEnd">10</span> dari <span id="businessTotalRecords">0</span> data
                    </div>
                    <div class="flex space-x-2" id="businessPagination">
                        <!-- Pagination buttons will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Jenis Koperasi Tab -->
        <div id="koperasi-content" class="tab-content hidden">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="mb-4 md:mb-0">
                        <h3 class="text-lg font-medium text-gray-900">Jenis Koperasi</h3>
                        <p class="text-sm text-gray-500">Kelola jenis-jenis koperasi</p>
                    </div>
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex">
                            <input type="text" id="searchKoperasiInput" placeholder="Cari jenis koperasi..." class="px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <button onclick="searchJenisKoperasi()" class="px-4 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-md hover:bg-gray-200">
                                <i class="fas fa-search text-gray-600"></i>
                            </button>
                        </div>
                        <button onclick="openAddKoperasiModal()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i>
                            Tambah Jenis
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Desktop Table View -->
            <div class="hidden md:block overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Jenis</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Deskripsi</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal Dibuat</th>
                            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="jenisKoperasiTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
            
            <!-- Mobile Card View -->
            <div class="md:hidden" id="jenisKoperasiCardContainer">
                <!-- Mobile cards will be loaded here -->
            </div>
            
            <!-- Pagination -->
            <div class="px-6 py-4 border-t border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-700">
                        Menampilkan <span id="koperasiShowingStart">1</span> sampai <span id="koperasiShowingEnd">10</span> dari <span id="koperasiTotalRecords">0</span> data
                    </div>
                    <div class="flex space-x-2" id="koperasiPagination">
                        <!-- Pagination buttons will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- UKM Tab -->
        <div id="ukm-content" class="tab-content hidden">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="mb-4 md:mb-0">
                        <h3 class="text-lg font-medium text-gray-900">Usaha Kecil Menengah (UKM)</h3>
                        <p class="text-sm text-gray-500">Kelola data UKM di desa</p>
                    </div>
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex">
                            <input type="text" id="searchUkmInput" placeholder="Cari UKM..." class="px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <button onclick="searchUkm()" class="px-4 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-md hover:bg-gray-200">
                                <i class="fas fa-search text-gray-600"></i>
                            </button>
                        </div>
                        <button onclick="openAddUkmModal()" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i>
                            Tambah UKM
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Desktop Table View -->
            <div class="hidden md:block overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Usaha</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pemilik</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Jenis Usaha</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Skala</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="ukmTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
            
            <!-- Mobile Card View -->
            <div class="md:hidden" id="ukmCardContainer">
                <!-- Mobile cards will be loaded here -->
            </div>
            
            <!-- Pagination -->
            <div class="px-6 py-4 border-t border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-700">
                        Menampilkan <span id="ukmShowingStart">1</span> sampai <span id="ukmShowingEnd">10</span> dari <span id="ukmTotalRecords">0</span> data
                    </div>
                    <div class="flex space-x-2" id="ukmPagination">
                        <!-- Pagination buttons will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- BUMG Tab -->
        <div id="bumg-content" class="tab-content hidden">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="mb-4 md:mb-0">
                        <h3 class="text-lg font-medium text-gray-900">Badan Usaha Milik Gampong (BUMG)</h3>
                        <p class="text-sm text-gray-500">Kelola data BUMG di desa</p>
                    </div>
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex">
                            <input type="text" id="searchBumgInput" placeholder="Cari BUMG..." class="px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <button onclick="searchBumg()" class="px-4 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-md hover:bg-gray-200">
                                <i class="fas fa-search text-gray-600"></i>
                            </button>
                        </div>
                        <button onclick="openAddBumgModal()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i>
                            Tambah BUMG
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Desktop Table View -->
            <div class="hidden md:block overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama BUMG</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Direktur</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bidang Usaha</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Modal Disetor</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="bumgTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
            
            <!-- Mobile Card View -->
            <div class="md:hidden" id="bumgCardContainer">
                <!-- Mobile cards will be loaded here -->
            </div>
            
            <!-- Pagination -->
            <div class="px-6 py-4 border-t border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-700">
                        Menampilkan <span id="bumgShowingStart">1</span> sampai <span id="bumgShowingEnd">10</span> dari <span id="bumgTotalRecords">0</span> data
                    </div>
                    <div class="flex space-x-2" id="bumgPagination">
                        <!-- Pagination buttons will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Kategori Jasa Tab -->
        <div id="jasa-content" class="tab-content hidden">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="mb-4 md:mb-0">
                        <h3 class="text-lg font-medium text-gray-900">Kategori Layanan Jasa</h3>
                        <p class="text-sm text-gray-500">Kelola kategori layanan jasa</p>
                    </div>
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex">
                            <input type="text" id="searchLayananJasaInput" placeholder="Cari layanan jasa..." class="px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <button onclick="searchLayananJasa()" class="px-4 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-md hover:bg-gray-200">
                                <i class="fas fa-search text-gray-600"></i>
                            </button>
                        </div>
                        <button onclick="openAddLayananJasaModal()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i>
                            Tambah Layanan Jasa
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Desktop Table View -->
            <div class="hidden md:block overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Layanan</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kategori</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Deskripsi</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="layananJasaTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
            
            <!-- Mobile Card View -->
            <div class="md:hidden" id="layananJasaCardContainer">
                <!-- Mobile cards will be loaded here -->
            </div>
            
            <!-- Pagination -->
            <div class="px-6 py-4 border-t border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-700">
                        Menampilkan <span id="layananJasaShowingStart">1</span> sampai <span id="layananJasaShowingEnd">10</span> dari <span id="layananJasaTotalRecords">0</span> data
                    </div>
                    <div class="flex space-x-2" id="layananJasaPagination">
                        <!-- Pagination buttons will be generated here -->
                    </div>
                </div>
            </div>
            
            
        <!-- Kategori Aset Tab -->
        <div id="aset-content" class="tab-content hidden">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="mb-4 md:mb-0">
                        <h3 class="text-lg font-medium text-gray-900">Kategori Aset</h3>
                        <p class="text-sm text-gray-500">Kelola kategori aset</p>
                    </div>
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex">
                            <input type="text" id="searchAsetInput" placeholder="Cari aset..." class="px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            <button onclick="searchAset()" class="px-4 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-md hover:bg-gray-200">
                                <i class="fas fa-search text-gray-600"></i>
                            </button>
                        </div>
                        <button onclick="openAddAsetModal()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i>
                            Tambah Aset
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Desktop Table View -->
            <div class="hidden md:block overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Aset</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kategori</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nilai</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kondisi</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="asetTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
            
            <!-- Mobile Card View -->
            <div class="md:hidden" id="asetCardContainer">
                <!-- Mobile cards will be loaded here -->
            </div>
            
            <!-- Pagination -->
            <div class="px-6 py-4 border-t border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-700">
                        Menampilkan <span id="asetShowingStart">1</span> sampai <span id="asetShowingEnd">10</span> dari <span id="asetTotalRecords">0</span> data
                    </div>
                    <div class="flex space-x-2" id="asetPagination">
                        <!-- Pagination buttons will be generated here -->
                    </div>
                </div>
            </div>
            
            <!-- Aset Data Table -->
            <div class="p-6">
                <!-- Desktop Table -->
                <div class="hidden md:block overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Aset</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Deskripsi</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal Dibuat</th>
                                <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="asetTableBody">
                            <!-- Data will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Mobile Cards -->
                <div class="md:hidden space-y-4" id="asetCardContainer">
                    <!-- Cards will be loaded here -->
                </div>
                
                <!-- Pagination -->
                <div class="flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-4">
                    <div class="flex flex-1 justify-between sm:hidden">
                        <button id="asetPrevMobile" class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Previous</button>
                        <button id="asetNextMobile" class="relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Next</button>
                    </div>
                    <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
                        <div>
                            <p class="text-sm text-gray-700" id="asetPaginationInfo">
                                Showing <span class="font-medium">1</span> to <span class="font-medium">10</span> of <span class="font-medium">0</span> results
                            </p>
                        </div>
                        <div>
                            <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" id="asetPaginationNav">
                                <!-- Pagination buttons will be generated here -->
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Business Category Modal -->
<div id="businessCategoryModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white">
        <div class="mt-3">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-900" id="businessModalTitle">Tambah Kategori Bisnis</h3>
                <button onclick="closeBusinessModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="businessCategoryForm" class="space-y-4">
                <input type="hidden" id="businessCategoryId">
                {% csrf_token %}
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Kategori *</label>
                    <input type="text" id="businessCategoryName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="businessCategoryDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="businessCategoryIsActive" checked class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                    <label for="businessCategoryIsActive" class="ml-2 block text-sm text-gray-900">Aktif</label>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeBusinessModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                        Batal
                    </button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                        <i class="fas fa-save mr-2"></i>Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Jenis Koperasi Modal -->
<div id="jenisKoperasiModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white">
        <div class="mt-3">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-900" id="koperasiModalTitle">Tambah Jenis Koperasi</h3>
                <button onclick="closeKoperasiModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="jenisKoperasiForm" class="space-y-4">
                <input type="hidden" id="jenisKoperasiId">
                {% csrf_token %}
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Jenis Koperasi *</label>
                    <input type="text" id="jenisKoperasiName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="jenisKoperasiDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="jenisKoperasiIsActive" checked class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                    <label for="jenisKoperasiIsActive" class="ml-2 block text-sm text-gray-900">Aktif</label>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeKoperasiModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                        Batal
                    </button>
                    <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
                        <i class="fas fa-save mr-2"></i>Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
            <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4">
                <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
            </div>
            <h3 class="text-lg font-medium text-gray-900 mb-2">Konfirmasi Hapus</h3>
            <div class="mt-2 px-7 py-3">
                <p class="text-sm text-gray-500 mb-4">
                    Apakah Anda yakin ingin menghapus <span id="deleteItemType">kategori</span> <strong id="deleteItemName"></strong>?
                </p>
                <p class="text-xs text-red-600">
                    Tindakan ini tidak dapat dibatalkan!
                </p>
            </div>
            <div class="flex justify-center space-x-3 pt-4">
                <button id="confirmDeleteBtn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
                    <i class="fas fa-trash mr-2"></i>Ya, Hapus
                </button>
                <button onclick="closeDeleteModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500">
                    <i class="fas fa-times mr-2"></i>Batal
                </button>
            </div>
        </div>
    </div>
</div>

<!-- UKM Modal -->
<div id="ukmModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white">
        <div class="mt-3">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-900" id="ukmModalTitle">Tambah UKM</h3>
                <button onclick="closeUkmModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="ukmForm" class="space-y-4">
                <input type="hidden" id="ukmId">
                {% csrf_token %}
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama UKM *</label>
                    <input type="text" id="ukmName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="ukmDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"></textarea>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="ukmIsActive" checked class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                    <label for="ukmIsActive" class="ml-2 block text-sm text-gray-900">Aktif</label>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeUkmModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                        Batal
                    </button>
                    <button type="submit" class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700">
                        <i class="fas fa-save mr-2"></i>Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- BUMG Modal -->
<div id="bumgModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white">
        <div class="mt-3">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-900" id="bumgModalTitle">Tambah BUMG</h3>
                <button onclick="closeBumgModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="bumgForm" class="space-y-4">
                <input type="hidden" id="bumgId">
                {% csrf_token %}
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama BUMG *</label>
                    <input type="text" id="bumgName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="bumgDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="bumgIsActive" checked class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                    <label for="bumgIsActive" class="ml-2 block text-sm text-gray-900">Aktif</label>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeBumgModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                        Batal
                    </button>
                    <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">
                        <i class="fas fa-save mr-2"></i>Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Layanan Jasa Modal -->
<div id="layananJasaModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white">
        <div class="mt-3">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-900" id="layananJasaModalTitle">Tambah Layanan Jasa</h3>
                <button onclick="closeLayananJasaModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="layananJasaForm" class="space-y-4">
                <input type="hidden" id="layananJasaId">
                {% csrf_token %}
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Layanan Jasa *</label>
                    <input type="text" id="layananJasaName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="layananJasaDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500"></textarea>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="layananJasaIsActive" checked class="h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300 rounded">
                    <label for="layananJasaIsActive" class="ml-2 block text-sm text-gray-900">Aktif</label>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeLayananJasaModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                        Batal
                    </button>
                    <button type="submit" class="px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700">
                        <i class="fas fa-save mr-2"></i>Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Aset Modal -->
<div id="asetModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white">
        <div class="mt-3">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-900" id="asetModalTitle">Tambah Aset</h3>
                <button onclick="closeAsetModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="asetForm" class="space-y-4">
                <input type="hidden" id="asetId">
                {% csrf_token %}
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Aset *</label>
                    <input type="text" id="asetName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kategori Aset *</label>
                    <select id="asetCategory" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500">
                        <option value="">Pilih Kategori</option>
                        <option value="tanah">Tanah</option>
                        <option value="bangunan">Bangunan</option>
                        <option value="kendaraan">Kendaraan</option>
                        <option value="peralatan">Peralatan</option>
                        <option value="inventaris">Inventaris</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="asetDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"></textarea>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="asetIsActive" checked class="h-4 w-4 text-gray-600 focus:ring-gray-500 border-gray-300 rounded">
                    <label for="asetIsActive" class="ml-2 block text-sm text-gray-900">Aktif</label>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeAsetModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                        Batal
                    </button>
                    <button type="submit" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700">
                        <i class="fas fa-save mr-2"></i>Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Global variables
let currentTab = 'business';
let currentPage = 1;
let currentKoperasiPage = 1;
let currentLayananJasaPage = 1;
let currentAsetPage = 1;
let currentUkmPage = 1;
let currentBumgPage = 1;
let deleteId = null;
let deleteType = 'business';
let businessCategoryData = [];
let jenisKoperasiData = [];
let layananJasaData = [];
let asetData = [];
let ukmData = [];
let bumgData = [];
let koperasiData = [];

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    // Load initial tab data (business categories)
    loadBusinessCategories();
    updateStatistics();
});

// Tab switching
function switchTab(tabName) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.add('hidden');
        content.classList.remove('active');
    });
    
    // Remove active class from all tab buttons
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active', 'border-blue-500', 'text-blue-600');
        button.classList.add('border-transparent', 'text-gray-500');
    });
    
    // Show selected tab content
    document.getElementById(tabName + '-content').classList.remove('hidden');
    document.getElementById(tabName + '-content').classList.add('active');
    
    // Add active class to selected tab button
    const activeButton = document.getElementById(tabName + '-tab');
    activeButton.classList.add('active', 'border-blue-500', 'text-blue-600');
    activeButton.classList.remove('border-transparent', 'text-gray-500');
    
    currentTab = tabName;
    
    // Load data for the selected tab if not already loaded
    switch(tabName) {
        case 'business':
            if (businessCategoryData.length === 0) loadBusinessCategories();
            break;
        case 'koperasi':
            if (jenisKoperasiData.length === 0) loadJenisKoperasi();
            break;
        case 'ukm':
            if (ukmData.length === 0) loadUkm();
            break;
        case 'bumg':
            if (bumgData.length === 0) loadBumg();
            break;
        case 'jasa':
            if (layananJasaData.length === 0) loadLayananJasa();
            break;
        case 'aset':
            if (asetData.length === 0) loadAset();
            break;
    }
}

// Load business categories
function loadBusinessCategories(page = 1, search = '') {
    const url = `/pulosarok/business/api/category/?page=${page}&search=${encodeURIComponent(search)}`;
    
    fetch(url)
        .then(response => response.json())
        .then(data => {
            businessCategoryData = data.data;
            displayBusinessCategories(data.data);
            updateBusinessPagination(data.page, data.total_pages);
            updateBusinessStatistics(data.total);
        })
        .catch(error => {
            console.error('Error loading business categories:', error);
            showAlert('Error loading business categories: ' + error.message, 'error');
        });
}

// Display business categories
function displayBusinessCategories(categories) {
    const tbody = document.getElementById('businessCategoryTableBody');
    const cardContainer = document.getElementById('businessCategoryCardContainer');
    
    tbody.innerHTML = '';
    cardContainer.innerHTML = '';
    
    if (categories.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500">Tidak ada data kategori bisnis</td></tr>';
        cardContainer.innerHTML = '<div class="p-6 text-center text-gray-500">Tidak ada data kategori bisnis</div>';
        return;
    }
    
    categories.forEach((category, index) => {
        const statusBadge = category.is_active ? 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Aktif</span>' : 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Tidak Aktif</span>';
            
        // Desktop table row
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50';
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${(currentPage - 1) * 20 + index + 1}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${category.name}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${category.description || '-'}</td>
            <td class="px-6 py-4 whitespace-nowrap">${statusBadge}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(category.created_at).toLocaleDateString('id-ID')}</td>
            <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                <button onclick="editBusinessCategory(${category.id})" class="text-blue-600 hover:text-blue-900 mr-3">
                    <i class="fas fa-edit"></i>
                </button>
                <button onclick="deleteBusinessCategory(${category.id}, '${category.name}')" class="text-red-600 hover:text-red-900">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        `;
        tbody.appendChild(row);
        
        // Mobile card
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-md border border-gray-200 p-4 mb-4 hover:shadow-lg transition-shadow duration-200';
        card.innerHTML = `
            <div class="flex justify-between items-start mb-3">
                <div class="flex-1">
                    <h4 class="text-lg font-semibold text-gray-900 mb-1">${category.name}</h4>
                    <p class="text-sm text-gray-600 leading-relaxed">${category.description || 'Tidak ada deskripsi'}</p>
                </div>
                <div class="ml-3 flex-shrink-0">${statusBadge}</div>
            </div>
            <div class="text-xs text-gray-500 mb-3 pb-3 border-b border-gray-100">
                <i class="fas fa-calendar-alt mr-1"></i>Dibuat: ${new Date(category.created_at).toLocaleDateString('id-ID')}
            </div>
            <div class="flex gap-2">
                <button onclick="editBusinessCategory(${category.id})" class="flex-1 bg-blue-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-edit mr-2"></i>Edit
                </button>
                <button onclick="deleteBusinessCategory(${category.id}, '${category.name}')" class="flex-1 bg-red-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-trash mr-2"></i>Hapus
                </button>
            </div>
        `;
        cardContainer.appendChild(card);
    });
}

// Load jenis koperasi
function loadJenisKoperasi(page = 1, search = '') {
    const url = `/pulosarok/business/api/jenis-koperasi/?page=${page}&search=${encodeURIComponent(search)}`;
    
    fetch(url)
        .then(response => response.json())
        .then(data => {
            jenisKoperasiData = data.data;
            displayJenisKoperasi(data.data);
            updateKoperasiPagination(data.page, data.total_pages);
            updateKoperasiStatistics(data.total);
        })
        .catch(error => {
            console.error('Error loading jenis koperasi:', error);
            showAlert('Error loading jenis koperasi: ' + error.message, 'error');
        });
}

// Display jenis koperasi
function displayJenisKoperasi(jenisKoperasi) {
    const tbody = document.getElementById('jenisKoperasiTableBody');
    const cardContainer = document.getElementById('jenisKoperasiCardContainer');
    
    tbody.innerHTML = '';
    cardContainer.innerHTML = '';
    
    if (jenisKoperasi.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500">Tidak ada data jenis koperasi</td></tr>';
        cardContainer.innerHTML = '<div class="p-6 text-center text-gray-500">Tidak ada data jenis koperasi</div>';
        return;
    }
    
    jenisKoperasi.forEach((jenis, index) => {
        const statusBadge = jenis.is_active ? 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Aktif</span>' : 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Tidak Aktif</span>';
            
        // Desktop table row
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50';
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${(currentKoperasiPage - 1) * 20 + index + 1}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${jenis.nama}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${jenis.deskripsi || '-'}</td>
            <td class="px-6 py-4 whitespace-nowrap">${statusBadge}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(jenis.created_at).toLocaleDateString('id-ID')}</td>
            <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                <button onclick="editJenisKoperasi(${jenis.id})" class="text-green-600 hover:text-green-900 mr-3">
                    <i class="fas fa-edit"></i>
                </button>
                <button onclick="deleteJenisKoperasi(${jenis.id}, '${jenis.nama}')" class="text-red-600 hover:text-red-900">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        `;
        tbody.appendChild(row);
        
        // Mobile card
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-md border border-gray-200 p-4 mb-4 hover:shadow-lg transition-shadow duration-200';
        card.innerHTML = `
            <div class="flex justify-between items-start mb-3">
                <div class="flex-1">
                    <h4 class="text-lg font-semibold text-gray-900 mb-1">${jenis.nama}</h4>
                    <p class="text-sm text-gray-600 leading-relaxed">${jenis.deskripsi || 'Tidak ada deskripsi'}</p>
                </div>
                <div class="ml-3 flex-shrink-0">${statusBadge}</div>
            </div>
            <div class="text-xs text-gray-500 mb-3 pb-3 border-b border-gray-100">
                <i class="fas fa-calendar-alt mr-1"></i>Dibuat: ${new Date(jenis.created_at).toLocaleDateString('id-ID')}
            </div>
            <div class="flex gap-2">
                <button onclick="editJenisKoperasi(${jenis.id})" class="flex-1 bg-green-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-edit mr-2"></i>Edit
                </button>
                <button onclick="deleteJenisKoperasi(${jenis.id}, '${jenis.nama}')" class="flex-1 bg-red-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-trash mr-2"></i>Hapus
                </button>
            </div>
        `;
        cardContainer.appendChild(card);
    });
}

// Update statistics
function updateStatistics() {
    updateBusinessStatistics();
    updateKoperasiStatistics();
}

function updateBusinessStatistics(total = 0) {
    document.getElementById('totalBusinessCategories').textContent = total;
    const activeCount = businessCategoryData.filter(cat => cat.is_active).length;
    updateTotalActiveCategories();
}

function updateKoperasiStatistics(total = 0) {
    document.getElementById('totalJenisKoperasi').textContent = total;
    updateTotalActiveCategories();
}

function updateTotalActiveCategories() {
    const businessActive = businessCategoryData.filter(cat => cat.is_active).length;
    const koperasiActive = jenisKoperasiData.filter(jenis => jenis.is_active).length;
    document.getElementById('totalActiveCategories').textContent = businessActive + koperasiActive;
}

// Pagination functions
function updateBusinessPagination(current, totalPages) {
    currentPage = current;
    const pagination = document.getElementById('businessPagination');
    pagination.innerHTML = '';
    
    if (totalPages <= 1) return;
    
    // Previous button
    if (current > 1) {
        const prevBtn = document.createElement('button');
        prevBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50';
        prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
        prevBtn.onclick = () => loadBusinessCategories(current - 1);
        pagination.appendChild(prevBtn);
    }
    
    // Page numbers
    for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = i === current ? 
            'px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-gray-300' :
            'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 hover:bg-gray-50';
        pageBtn.textContent = i;
        pageBtn.onclick = () => loadBusinessCategories(i);
        pagination.appendChild(pageBtn);
    }
    
    // Next button
    if (current < totalPages) {
        const nextBtn = document.createElement('button');
        nextBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50';
        nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
        nextBtn.onclick = () => loadBusinessCategories(current + 1);
        pagination.appendChild(nextBtn);
    }
}

function updateKoperasiPagination(current, totalPages) {
    currentKoperasiPage = current;
    const pagination = document.getElementById('koperasiPagination');
    pagination.innerHTML = '';
    
    if (totalPages <= 1) return;
    
    // Previous button
    if (current > 1) {
        const prevBtn = document.createElement('button');
        prevBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50';
        prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
        prevBtn.onclick = () => loadJenisKoperasi(current - 1);
        pagination.appendChild(prevBtn);
    }
    
    // Page numbers
    for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = i === current ? 
            'px-3 py-2 text-sm font-medium text-green-600 bg-green-50 border border-gray-300' :
            'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 hover:bg-gray-50';
        pageBtn.textContent = i;
        pageBtn.onclick = () => loadJenisKoperasi(i);
        pagination.appendChild(pageBtn);
    }
    
    // Next button
    if (current < totalPages) {
        const nextBtn = document.createElement('button');
        nextBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50';
        nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
        nextBtn.onclick = () => loadJenisKoperasi(current + 1);
        pagination.appendChild(nextBtn);
    }
}

// Modal functions
function openAddBusinessModal() {
    document.getElementById('businessModalTitle').textContent = 'Tambah Kategori Bisnis';
    document.getElementById('businessCategoryForm').reset();
    document.getElementById('businessCategoryId').value = '';
    document.getElementById('businessCategoryIsActive').checked = true;
    document.getElementById('businessCategoryModal').classList.remove('hidden');
}

function openAddKoperasiModal() {
    document.getElementById('koperasiModalTitle').textContent = 'Tambah Jenis Koperasi';
    document.getElementById('jenisKoperasiForm').reset();
    document.getElementById('jenisKoperasiId').value = '';
    document.getElementById('jenisKoperasiIsActive').checked = true;
    document.getElementById('jenisKoperasiModal').classList.remove('hidden');
}

// Modal functions for new tabs
function openAddUkmModal() {
    document.getElementById('ukmModalTitle').textContent = 'Tambah UKM';
    document.getElementById('ukmForm').reset();
    document.getElementById('ukmId').value = '';
    document.getElementById('ukmIsActive').checked = true;
    document.getElementById('ukmModal').classList.remove('hidden');
}

function openAddBumgModal() {
    document.getElementById('bumgModalTitle').textContent = 'Tambah BUMG';
    document.getElementById('bumgForm').reset();
    document.getElementById('bumgId').value = '';
    document.getElementById('bumgIsActive').checked = true;
    document.getElementById('bumgModal').classList.remove('hidden');
}

function openAddLayananJasaModal() {
    document.getElementById('layananJasaModalTitle').textContent = 'Tambah Layanan Jasa';
    document.getElementById('layananJasaForm').reset();
    document.getElementById('layananJasaId').value = '';
    document.getElementById('layananJasaIsActive').checked = true;
    document.getElementById('layananJasaModal').classList.remove('hidden');
}

function openAddAsetModal() {
    document.getElementById('asetModalTitle').textContent = 'Tambah Aset';
    document.getElementById('asetForm').reset();
    document.getElementById('asetId').value = '';
    document.getElementById('asetIsActive').checked = true;
    document.getElementById('asetModal').classList.remove('hidden');
}

function editBusinessCategory(id) {
    const category = businessCategoryData.find(cat => cat.id === id);
    if (!category) return;
    
    document.getElementById('businessModalTitle').textContent = 'Edit Kategori Bisnis';
    document.getElementById('businessCategoryId').value = category.id;
    document.getElementById('businessCategoryName').value = category.name;
    document.getElementById('businessCategoryDescription').value = category.description || '';
    document.getElementById('businessCategoryIsActive').checked = category.is_active;
    
    document.getElementById('businessCategoryModal').classList.remove('hidden');
}

function editJenisKoperasi(id) {
    const jenis = jenisKoperasiData.find(j => j.id === id);
    if (!jenis) return;
    
    document.getElementById('koperasiModalTitle').textContent = 'Edit Jenis Koperasi';
    document.getElementById('jenisKoperasiId').value = jenis.id;
    document.getElementById('jenisKoperasiName').value = jenis.nama;
    document.getElementById('jenisKoperasiDescription').value = jenis.deskripsi || '';
    document.getElementById('jenisKoperasiIsActive').checked = jenis.is_active;
    
    document.getElementById('jenisKoperasiModal').classList.remove('hidden');
}

function closeBusinessModal() {
    document.getElementById('businessCategoryModal').classList.add('hidden');
}

function closeKoperasiModal() {
    document.getElementById('jenisKoperasiModal').classList.add('hidden');
}

function closeUkmModal() {
    document.getElementById('ukmModal').classList.add('hidden');
}

function closeBumgModal() {
    document.getElementById('bumgModal').classList.add('hidden');
}

function closeLayananJasaModal() {
    document.getElementById('layananJasaModal').classList.add('hidden');
}

function closeAsetModal() {
    document.getElementById('asetModal').classList.add('hidden');
}

function closeDeleteModal() {
    document.getElementById('deleteModal').classList.add('hidden');
    deleteId = null;
    deleteType = 'business';
}

// Delete functions
function deleteBusinessCategory(id, name) {
    deleteId = id;
    deleteType = 'business';
    document.getElementById('deleteItemType').textContent = 'kategori bisnis';
    document.getElementById('deleteItemName').textContent = name;
    document.getElementById('deleteModal').classList.remove('hidden');
}

function deleteJenisKoperasi(id, name) {
    deleteId = id;
    deleteType = 'koperasi';
    document.getElementById('deleteItemType').textContent = 'jenis koperasi';
    document.getElementById('deleteItemName').textContent = name;
    document.getElementById('deleteModal').classList.remove('hidden');
}

// Search functions
function searchBusinessCategories() {
    const search = document.getElementById('searchBusinessInput').value;
    loadBusinessCategories(1, search);
}

function searchJenisKoperasi() {
    const search = document.getElementById('searchKoperasiInput').value;
    loadJenisKoperasi(1, search);
}

// Form submissions
document.getElementById('businessCategoryForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = {
        name: document.getElementById('businessCategoryName').value,
        description: document.getElementById('businessCategoryDescription').value,
        is_active: document.getElementById('businessCategoryIsActive').checked
    };
    
    const id = document.getElementById('businessCategoryId').value;
    const url = '/pulosarok/business/api/category/';
    const method = id ? 'PUT' : 'POST';
    
    if (id) {
        formData.id = parseInt(id);
    }
    
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(id ? 'Kategori bisnis berhasil diperbarui' : 'Kategori bisnis berhasil ditambahkan', 'success');
            loadBusinessCategories(currentPage);
            closeBusinessModal();
        } else {
            showAlert('Error: ' + data.error, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('Terjadi kesalahan: ' + error.message, 'error');
    });
});

document.getElementById('jenisKoperasiForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = {
        nama: document.getElementById('jenisKoperasiName').value,
        deskripsi: document.getElementById('jenisKoperasiDescription').value,
        is_active: document.getElementById('jenisKoperasiIsActive').checked
    };
    
    const id = document.getElementById('jenisKoperasiId').value;
    const url = '/pulosarok/business/api/jenis-koperasi/';
    const method = id ? 'PUT' : 'POST';
    
    if (id) {
        formData.id = parseInt(id);
    }
    
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(id ? 'Jenis koperasi berhasil diperbarui' : 'Jenis koperasi berhasil ditambahkan', 'success');
            loadJenisKoperasi(currentKoperasiPage);
            closeKoperasiModal();
        } else {
            showAlert('Error: ' + data.error, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('Terjadi kesalahan: ' + error.message, 'error');
    });
});

// Confirm delete
document.getElementById('confirmDeleteBtn').addEventListener('click', function() {
    if (!deleteId) return;
    
    let apiUrl, successMessage;
    
    switch(deleteType) {
        case 'business':
            apiUrl = '/pulosarok/business/api/category/';
            successMessage = 'Kategori bisnis berhasil dihapus';
            break;
        case 'jenis_koperasi':
            apiUrl = '/pulosarok/business/api/jenis-koperasi/';
            successMessage = 'Jenis koperasi berhasil dihapus';
            break;
        case 'layanan_jasa':
            apiUrl = '/pulosarok/business/api/jasa/';
            successMessage = 'Layanan jasa berhasil dihapus';
            break;
        case 'aset':
            apiUrl = '/pulosarok/business/api/aset/';
            successMessage = 'Aset berhasil dihapus';
            break;
        default:
            apiUrl = '/pulosarok/business/api/category/';
            successMessage = 'Item berhasil dihapus';
    }
    
    fetch(apiUrl, {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify({ id: deleteId })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(successMessage, 'success');
            switch(deleteType) {
                case 'business':
                    loadBusinessCategories(currentPage);
                    break;
                case 'jenis_koperasi':
                    loadJenisKoperasi(currentKoperasiPage);
                    break;
                case 'layanan_jasa':
                    loadLayananJasa(currentLayananJasaPage);
                    break;
                case 'aset':
                    loadAset(currentAsetPage);
                    break;
            }
            closeDeleteModal();
        } else {
            showAlert('Error: ' + data.error, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('Terjadi kesalahan: ' + error.message, 'error');
    });
});

// Utility functions
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function showAlert(message, type) {
    // Create toast notification
    const toast = document.createElement('div');
    toast.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 translate-x-full`;
    
    if (type === 'success') {
        toast.classList.add('bg-green-500', 'text-white');
        toast.innerHTML = `
            <div class="flex items-center">
                <i class="fas fa-check-circle mr-3"></i>
                <span>${message}</span>
                <button onclick="this.parentElement.parentElement.remove()" class="ml-3 text-white hover:text-gray-200">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `;
    } else {
        toast.classList.add('bg-red-500', 'text-white');
        toast.innerHTML = `
            <div class="flex items-center">
                <i class="fas fa-exclamation-circle mr-3"></i>
                <span>${message}</span>
                <button onclick="this.parentElement.parentElement.remove()" class="ml-3 text-white hover:text-gray-200">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `;
    }
    
    document.body.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
        toast.classList.remove('translate-x-full');
    }, 100);
    
    // Auto remove after 5 seconds
    setTimeout(() => {
        toast.classList.add('translate-x-full');
        setTimeout(() => {
            if (toast.parentElement) {
                toast.remove();
            }
        }, 300);
    }, 5000);
}

// Search on Enter key press
document.getElementById('searchBusinessInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        searchBusinessCategories();
    }
});

document.getElementById('searchKoperasiInput').addEventListener('keypress', function(e) {
     if (e.key === 'Enter') {
         searchJenisKoperasi();
     }
 });
 
// Load UKM data
function loadUkm(page = 1, search = '') {
    const url = `/pulosarok/business/api/ukm/?page=${page}&search=${encodeURIComponent(search)}`;
    
    fetch(url, {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        }
    })
        .then(response => response.json())
        .then(data => {
            ukmData = data.data;
            displayUkm(data.data);
            updateUkmPagination(data.page, data.total_pages);
        })
        .catch(error => {
            console.error('Error loading UKM:', error);
            showAlert('Error loading UKM: ' + error.message, 'error');
        });
}

// Display UKM data
function displayUkm(ukm) {
    const tbody = document.getElementById('ukmTableBody');
    const cardContainer = document.getElementById('ukmCardContainer');
    
    if (!tbody || !cardContainer) {
        console.error('UKM table body or card container not found');
        return;
    }
    
    tbody.innerHTML = '';
    cardContainer.innerHTML = '';
    
    if (ukm.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="px-6 py-4 text-center text-gray-500">Tidak ada data UKM</td></tr>';
        cardContainer.innerHTML = '<div class="p-6 text-center text-gray-500">Tidak ada data UKM</div>';
        return;
    }
    
    ukm.forEach((usaha, index) => {
        const statusBadge = usaha.status === 'aktif' ? 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Aktif</span>' : 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Tidak Aktif</span>';
            
        // Desktop table row
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50';
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${(currentUkmPage - 1) * 10 + index + 1}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${usaha.nama_usaha}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${usaha.pemilik || '-'}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${usaha.jenis_usaha || '-'}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${usaha.skala || '-'}</td>
            <td class="px-6 py-4 whitespace-nowrap">${statusBadge}</td>
            <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                <button onclick="editUkm(${usaha.id})" class="text-orange-600 hover:text-orange-900 mr-3">
                    <i class="fas fa-edit"></i>
                </button>
                <button onclick="deleteUkm(${usaha.id}, '${usaha.nama_usaha}')" class="text-red-600 hover:text-red-900">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        `;
        tbody.appendChild(row);
        
        // Mobile card
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-md border border-gray-200 p-4 mb-4 hover:shadow-lg transition-shadow duration-200';
        card.innerHTML = `
            <div class="flex justify-between items-start mb-3">
                <div class="flex-1">
                    <h4 class="text-lg font-semibold text-gray-900 mb-1">${usaha.nama_usaha}</h4>
                    <p class="text-sm text-gray-600">Pemilik: ${usaha.pemilik || '-'}</p>
                    <p class="text-sm text-gray-600">Jenis: ${usaha.jenis_usaha || '-'}</p>
                    <p class="text-sm text-gray-600">Skala: ${usaha.skala || '-'}</p>
                </div>
                <div class="ml-3 flex-shrink-0">${statusBadge}</div>
            </div>
            <div class="flex gap-2">
                <button onclick="editUkm(${usaha.id})" class="flex-1 bg-orange-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-orange-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-edit mr-2"></i>Edit
                </button>
                <button onclick="deleteUkm(${usaha.id}, '${usaha.nama_usaha}')" class="flex-1 bg-red-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-trash mr-2"></i>Hapus
                </button>
            </div>
        `;
        cardContainer.appendChild(card);
    });
}

// Load BUMG data
function loadBumg(page = 1, search = '') {
    const url = `/pulosarok/business/api/bumg/?page=${page}&search=${encodeURIComponent(search)}`;
    
    fetch(url, {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        }
    })
        .then(response => response.json())
        .then(data => {
            bumgData = data.data;
            displayBumg(data.data);
            updateBumgPagination(data.page, data.total_pages);
        })
        .catch(error => {
            console.error('Error loading BUMG:', error);
            showAlert('Error loading BUMG: ' + error.message, 'error');
        });
}

// Display BUMG data
function displayBumg(bumg) {
    const tbody = document.getElementById('bumgTableBody');
    const cardContainer = document.getElementById('bumgCardContainer');
    
    if (!tbody || !cardContainer) {
        console.error('BUMG table body or card container not found');
        return;
    }
    
    tbody.innerHTML = '';
    cardContainer.innerHTML = '';
    
    if (bumg.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="px-6 py-4 text-center text-gray-500">Tidak ada data BUMG</td></tr>';
        cardContainer.innerHTML = '<div class="p-6 text-center text-gray-500">Tidak ada data BUMG</div>';
        return;
    }
    
    bumg.forEach((badan, index) => {
        const statusBadge = badan.status === 'aktif' ? 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Aktif</span>' : 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Tidak Aktif</span>';
            
        // Desktop table row
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50';
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${(currentBumgPage - 1) * 10 + index + 1}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${badan.nama}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${badan.direktur || '-'}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${badan.bidang_usaha || '-'}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${badan.modal_disetor || '-'}</td>
            <td class="px-6 py-4 whitespace-nowrap">${statusBadge}</td>
            <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                <button onclick="editBumg(${badan.id})" class="text-purple-600 hover:text-purple-900 mr-3">
                    <i class="fas fa-edit"></i>
                </button>
                <button onclick="deleteBumg(${badan.id}, '${badan.nama}')" class="text-red-600 hover:text-red-900">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        `;
        tbody.appendChild(row);
        
        // Mobile card
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-md border border-gray-200 p-4 mb-4 hover:shadow-lg transition-shadow duration-200';
        card.innerHTML = `
            <div class="flex justify-between items-start mb-3">
                <div class="flex-1">
                    <h4 class="text-lg font-semibold text-gray-900 mb-1">${badan.nama}</h4>
                    <p class="text-sm text-gray-600">Direktur: ${badan.direktur || '-'}</p>
                    <p class="text-sm text-gray-600">Bidang: ${badan.bidang_usaha || '-'}</p>
                    <p class="text-sm text-gray-600">Modal: ${badan.modal_disetor || '-'}</p>
                </div>
                <div class="ml-3 flex-shrink-0">${statusBadge}</div>
            </div>
            <div class="flex gap-2">
                <button onclick="editBumg(${badan.id})" class="flex-1 bg-purple-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-purple-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-edit mr-2"></i>Edit
                </button>
                <button onclick="deleteBumg(${badan.id}, '${badan.nama}')" class="flex-1 bg-red-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-trash mr-2"></i>Hapus
                </button>
            </div>
        `;
        cardContainer.appendChild(card);
    });
}

// Update BUMG Pagination
function updateBumgPagination(current, totalPages) {
    currentBumgPage = current;
    const pagination = document.getElementById('bumgPagination');
    if (!pagination) return;
    
    pagination.innerHTML = '';
    
    if (totalPages <= 1) return;
    
    // Previous button
    if (current > 1) {
        const prevBtn = document.createElement('button');
        prevBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50';
        prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
        prevBtn.onclick = () => loadBumg(current - 1);
        pagination.appendChild(prevBtn);
    }
    
    // Page numbers
    for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = i === current ? 
            'px-3 py-2 text-sm font-medium text-purple-600 bg-purple-50 border border-gray-300' :
            'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 hover:bg-gray-50';
        pageBtn.textContent = i;
        pageBtn.onclick = () => loadBumg(i);
        pagination.appendChild(pageBtn);
    }
    
    // Next button
    if (current < totalPages) {
        const nextBtn = document.createElement('button');
        nextBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50';
        nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
        nextBtn.onclick = () => loadBumg(current + 1);
        pagination.appendChild(nextBtn);
    }
}

// Load Layanan Jasa data
function loadLayananJasa(page = 1, search = '') {
    const url = `/pulosarok/business/api/jasa/?page=${page}&search=${encodeURIComponent(search)}`;
    
    fetch(url, {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        }
    })
        .then(response => response.json())
        .then(data => {
            layananJasaData = data.data;
            displayLayananJasa(data.data);
            updateLayananJasaPagination(data.page, data.total_pages);
        })
        .catch(error => {
            console.error('Error loading layanan jasa:', error);
            showAlert('Error loading layanan jasa: ' + error.message, 'error');
        });
}

// Display Layanan Jasa data
function displayLayananJasa(layanan) {
    const tbody = document.getElementById('layananJasaTableBody');
    const cardContainer = document.getElementById('layananJasaCardContainer');
    
    if (!tbody || !cardContainer) {
        console.error('Layanan Jasa table body or card container not found');
        return;
    }
    
    tbody.innerHTML = '';
    cardContainer.innerHTML = '';
    
    if (layanan.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500">Tidak ada data Layanan Jasa</td></tr>';
        cardContainer.innerHTML = '<div class="p-6 text-center text-gray-500">Tidak ada data Layanan Jasa</div>';
        return;
    }
    
    layanan.forEach((jasa, index) => {
        const statusBadge = jasa.status === 'aktif' ? 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Aktif</span>' : 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Tidak Aktif</span>';
            
        // Desktop table row
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50';
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${(currentLayananJasaPage - 1) * 10 + index + 1}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${jasa.nama}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${jasa.kategori || '-'}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${jasa.penyedia || '-'}</td>
            <td class="px-6 py-4 whitespace-nowrap">${statusBadge}</td>
            <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                <button onclick="editLayananJasa(${jasa.id})" class="text-yellow-600 hover:text-yellow-900 mr-3">
                    <i class="fas fa-edit"></i>
                </button>
                <button onclick="deleteLayananJasa(${jasa.id}, '${jasa.nama}')" class="text-red-600 hover:text-red-900">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        `;
        tbody.appendChild(row);
        
        // Mobile card
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-md border border-gray-200 p-4 mb-4 hover:shadow-lg transition-shadow duration-200';
        card.innerHTML = `
            <div class="flex justify-between items-start mb-3">
                <div class="flex-1">
                    <h4 class="text-lg font-semibold text-gray-900 mb-1">${jasa.nama}</h4>
                    <p class="text-sm text-gray-600">${jasa.kategori || 'Tidak ada kategori'}</p>
                    <p class="text-sm text-gray-600">Penyedia: ${jasa.penyedia || '-'}</p>
                </div>
                <div class="ml-3 flex-shrink-0">${statusBadge}</div>
            </div>
            <div class="flex gap-2">
                <button onclick="editLayananJasa(${jasa.id})" class="flex-1 bg-yellow-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-yellow-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-edit mr-2"></i>Edit
                </button>
                <button onclick="deleteLayananJasa(${jasa.id}, '${jasa.nama}')" class="flex-1 bg-red-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-trash mr-2"></i>Hapus
                </button>
            </div>
        `;
        cardContainer.appendChild(card);
    });
}

// Load Aset data
function loadAset(page = 1, search = '') {
    const url = `/pulosarok/business/api/aset/?page=${page}&search=${encodeURIComponent(search)}`;
    
    fetch(url, {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        }
    })
        .then(response => response.json())
        .then(data => {
            asetData = data.data;
            displayAset(data.data);
            updateAsetPagination(data.page, data.total_pages);
        })
        .catch(error => {
            console.error('Error loading aset:', error);
            showAlert('Error loading aset: ' + error.message, 'error');
        });
}

// Display Aset data
function displayAset(aset) {
    const tbody = document.getElementById('asetTableBody');
    const cardContainer = document.getElementById('asetCardContainer');
    
    if (!tbody || !cardContainer) {
        console.error('Aset table body or card container not found');
        return;
    }
    
    tbody.innerHTML = '';
    cardContainer.innerHTML = '';
    
    if (aset.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500">Tidak ada data Aset</td></tr>';
        cardContainer.innerHTML = '<div class="p-6 text-center text-gray-500">Tidak ada data Aset</div>';
        return;
    }
    
    aset.forEach((asset, index) => {
        const kondisiBadge = asset.kondisi === 'baik' ? 
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Baik</span>' : 
            asset.kondisi === 'rusak' ?
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Rusak</span>' :
            '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">Perlu Perbaikan</span>';
            
        // Desktop table row
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50';
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${(currentAsetPage - 1) * 10 + index + 1}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${asset.nama_aset}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${asset.kategori || '-'}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${asset.lokasi || '-'}</td>
            <td class="px-6 py-4 whitespace-nowrap">${kondisiBadge}</td>
            <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                <button onclick="editAset(${asset.id})" class="text-gray-600 hover:text-gray-900 mr-3">
                    <i class="fas fa-edit"></i>
                </button>
                <button onclick="deleteAset(${asset.id}, '${asset.nama_aset}')" class="text-red-600 hover:text-red-900">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        `;
        tbody.appendChild(row);
        
        // Mobile card
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-md border border-gray-200 p-4 mb-4 hover:shadow-lg transition-shadow duration-200';
        card.innerHTML = `
            <div class="flex justify-between items-start mb-3">
                <div class="flex-1">
                    <h4 class="text-lg font-semibold text-gray-900 mb-1">${asset.nama_aset}</h4>
                    <p class="text-sm text-gray-600">${asset.kategori || 'Tidak ada kategori'}</p>
                    <p class="text-sm text-gray-600">Lokasi: ${asset.lokasi || '-'}</p>
                </div>
                <div class="ml-3 flex-shrink-0">${kondisiBadge}</div>
            </div>
            <div class="flex gap-2">
                <button onclick="editAset(${asset.id})" class="flex-1 bg-gray-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-edit mr-2"></i>Edit
                </button>
                <button onclick="deleteAset(${asset.id}, '${asset.nama_aset}')" class="flex-1 bg-red-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors duration-200 flex items-center justify-center">
                    <i class="fas fa-trash mr-2"></i>Hapus
                </button>
            </div>
        `;
        cardContainer.appendChild(card);
    });
}

// Search functions for new tabs
function searchUkm() {
    const search = document.getElementById('searchUkmInput').value;
    loadUkm(1, search);
}

function searchBumg() {
    const search = document.getElementById('searchBumgInput').value;
    loadBumg(1, search);
}

function searchLayananJasa() {
    const search = document.getElementById('searchLayananJasaInput').value;
    loadLayananJasa(1, search);
}

function searchAset() {
    const search = document.getElementById('searchAsetInput').value;
    loadAset(1, search);
}

// Modal functions for Layanan Jasa
function openAddLayananJasaModal() {
    document.getElementById('layananJasaModalTitle').textContent = 'Tambah Layanan Jasa';
    document.getElementById('layananJasaForm').reset();
    document.getElementById('layananJasaId').value = '';
    document.getElementById('layananJasaIsActive').checked = true;
    document.getElementById('layananJasaModal').classList.remove('hidden');
}

function closeLayananJasaModal() {
    document.getElementById('layananJasaModal').classList.add('hidden');
}

function editLayananJasa(id) {
    const jasa = layananJasaData.find(j => j.id === id);
    if (jasa) {
        document.getElementById('layananJasaModalTitle').textContent = 'Edit Layanan Jasa';
        document.getElementById('layananJasaId').value = jasa.id;
        document.getElementById('layananJasaName').value = jasa.nama;
        document.getElementById('layananJasaDescription').value = jasa.deskripsi || '';
        document.getElementById('layananJasaIsActive').checked = jasa.status === 'aktif';
        document.getElementById('layananJasaModal').classList.remove('hidden');
    }
}

function deleteLayananJasa(id, name) {
    deleteId = id;
    deleteType = 'layanan_jasa';
    document.getElementById('deleteItemName').textContent = name;
    document.getElementById('deleteModal').classList.remove('hidden');
}

// Modal functions for Aset (duplicate removed)

function editAset(id) {
    const asset = asetData.find(a => a.id === id);
    if (asset) {
        document.getElementById('asetModalTitle').textContent = 'Edit Aset';
        document.getElementById('asetId').value = asset.id;
        document.getElementById('asetName').value = asset.nama_aset;
        document.getElementById('asetCategory').value = asset.kategori || '';
        document.getElementById('asetDescription').value = asset.deskripsi || '';
        document.getElementById('asetIsActive').checked = asset.kondisi === 'baik';
        document.getElementById('asetModal').classList.remove('hidden');
    }
}

function deleteAset(id, name) {
    deleteId = id;
    deleteType = 'aset';
    document.getElementById('deleteItemName').textContent = name;
    document.getElementById('deleteModal').classList.remove('hidden');
}

// Pagination functions for new tabs
function updateLayananJasaPagination(current, totalPages) {
    currentLayananJasaPage = current;
    const pagination = document.getElementById('layananJasaPagination');
    if (!pagination) return;
    
    pagination.innerHTML = '';
    
    if (totalPages <= 1) return;
    
    // Previous button
    if (current > 1) {
        const prevBtn = document.createElement('button');
        prevBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50';
        prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
        prevBtn.onclick = () => loadLayananJasa(current - 1);
        pagination.appendChild(prevBtn);
    }
    
    // Page numbers
    for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = i === current ? 
            'px-3 py-2 text-sm font-medium text-yellow-600 bg-yellow-50 border border-gray-300' :
            'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 hover:bg-gray-50';
        pageBtn.textContent = i;
        pageBtn.onclick = () => loadLayananJasa(i);
        pagination.appendChild(pageBtn);
    }
    
    // Next button
    if (current < totalPages) {
        const nextBtn = document.createElement('button');
        nextBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50';
        nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
        nextBtn.onclick = () => loadLayananJasa(current + 1);
        pagination.appendChild(nextBtn);
    }
}

function updateAsetPagination(current, totalPages) {
    currentAsetPage = current;
    const pagination = document.getElementById('asetPagination');
    if (!pagination) return;
    
    pagination.innerHTML = '';
    
    if (totalPages <= 1) return;
    
    // Previous button
    if (current > 1) {
        const prevBtn = document.createElement('button');
        prevBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50';
        prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
        prevBtn.onclick = () => loadAset(current - 1);
        pagination.appendChild(prevBtn);
    }
    
    // Page numbers
    for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = i === current ? 
            'px-3 py-2 text-sm font-medium text-gray-600 bg-gray-50 border border-gray-300' :
            'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 hover:bg-gray-50';
        pageBtn.textContent = i;
        pageBtn.onclick = () => loadAset(i);
        pagination.appendChild(pageBtn);
    }
    
    // Next button
    if (current < totalPages) {
        const nextBtn = document.createElement('button');
        nextBtn.className = 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50';
        nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
        nextBtn.onclick = () => loadAset(current + 1);
        pagination.appendChild(nextBtn);
    }
}



// Form submission handlers for Layanan Jasa
document.getElementById('layananJasaForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const id = document.getElementById('layananJasaId').value;
    const formData = {
        nama: document.getElementById('layananJasaName').value,
        deskripsi: document.getElementById('layananJasaDescription').value,
        status: document.getElementById('layananJasaIsActive').checked ? 'aktif' : 'tidak_aktif'
    };
    
    const url = id ? `/pulosarok/business/api/jasa/` : `/pulosarok/business/api/jasa/`;
    const method = id ? 'PUT' : 'POST';
    
    if (id) {
        formData.id = parseInt(id);
    }
    
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(id ? 'Layanan jasa berhasil diperbarui' : 'Layanan jasa berhasil ditambahkan', 'success');
            loadLayananJasa(currentLayananJasaPage);
            closeLayananJasaModal();
        } else {
            showAlert('Error: ' + data.error, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('Terjadi kesalahan: ' + error.message, 'error');
    });
});

// Form submission handlers for Aset
document.getElementById('asetForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const id = document.getElementById('asetId').value;
    const formData = {
        nama_aset: document.getElementById('asetName').value,
        kategori: document.getElementById('asetCategory').value,
        deskripsi: document.getElementById('asetDescription').value,
        kondisi: document.getElementById('asetIsActive').checked ? 'baik' : 'rusak'
    };
    
    const url = id ? `/pulosarok/business/api/aset/` : `/pulosarok/business/api/aset/`;
    const method = id ? 'PUT' : 'POST';
    
    if (id) {
        formData.id = parseInt(id);
    }
    
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(id ? 'Aset berhasil diperbarui' : 'Aset berhasil ditambahkan', 'success');
            loadAset(currentAsetPage);
            closeAsetModal();
        } else {
            showAlert('Error: ' + data.error, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('Terjadi kesalahan: ' + error.message, 'error');
    });
});

// Form submission handlers for UKM
document.getElementById('ukmForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const id = document.getElementById('ukmId').value;
    const formData = {
        nama_usaha: document.getElementById('ukmName').value,
        deskripsi: document.getElementById('ukmDescription').value,
        status: document.getElementById('ukmIsActive').checked ? 'aktif' : 'tidak_aktif'
    };
    
    const url = id ? `/pulosarok/business/api/ukm/` : `/pulosarok/business/api/ukm/`;
    const method = id ? 'PUT' : 'POST';
    
    if (id) {
        formData.id = parseInt(id);
    }
    
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(id ? 'UKM berhasil diperbarui' : 'UKM berhasil ditambahkan', 'success');
            loadUkm(currentUkmPage);
            closeUkmModal();
        } else {
            showAlert('Error: ' + data.error, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('Terjadi kesalahan: ' + error.message, 'error');
    });
});

// Form submission handlers for BUMG
document.getElementById('bumgForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const id = document.getElementById('bumgId').value;
    const formData = {
        nama: document.getElementById('bumgName').value,
        deskripsi: document.getElementById('bumgDescription').value,
        status: document.getElementById('bumgIsActive').checked ? 'aktif' : 'tidak_aktif'
    };
    
    const url = id ? `/pulosarok/business/api/bumg/` : `/pulosarok/business/api/bumg/`;
    const method = id ? 'PUT' : 'POST';
    
    if (id) {
        formData.id = parseInt(id);
    }
    
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(id ? 'BUMG berhasil diperbarui' : 'BUMG berhasil ditambahkan', 'success');
            loadBumg(currentBumgPage);
            closeBumgModal();
        } else {
            showAlert('Error: ' + data.error, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('Terjadi kesalahan: ' + error.message, 'error');
    });
});


 </script>
 {% endblock %}